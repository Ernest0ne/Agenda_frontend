<div class="layout-main">

  <div class="layout-content layout-top">
    <div class="p-grid">
      <div class="p-col-12">
        <div class="card card-box">
          <span class="breadcrumb-desktop">
            <h1>
              <em class="title-icon icon-gestionBodega"></em>
              GESTIÓN DE NÓMINA
            </h1>

          </span>


          <div class="md-content" flex md-scroll-y>
            <div>
              <perfect-scrollbar class="content-overflow" [disabled]="funcionesGenerales.getDevice()">
                <div class="card">

                  <span class="breadcrumb-desktop">
                    <h1>LISTADO DE PAGOS REALIZADOS</h1>
                  </span>

                  <p-table class="VisActEli" emptyMessage="lista vacía" #dt [columns]="cols" class="tableList"
                    [value]="pagos" [paginator]="true" [rows]="10" [rowsPerPageOptions]="[10,20,50,100,200]">
                    <ng-template pTemplate="caption">
                      <div class="ui-helper-clearfix">
                        <div class="p-grid">
                          <div class="p-col-12 p-md-12 filter-container tableMenu">
                            <div style="position:initial" class="flex table-search">

                              <div class="p-col-12 p-md-12 flex organizarSelect">
                                <input type="text" pInputText placeholder="Buscar"
                                  (input)="dt.filterGlobal($event.target.value, 'contains')">
                              </div>

                              <div class="p-col-4 p-md-4 flex organizarSelect listExport childBefore">
                                <label class="totalRegistros">Total registros:
                                  {{totalRegistros}}</label>
                                <button type="button" pButton icon="icommon pi pi-download" iconPos="left"
                                  label="Exportar excel" (click)="exportExcel()" style="float:right"></button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-template>

                    <ng-template pTemplate="header" let-columns>
                      <tr>
                        <th *ngFor="let col of columns" class="{{col.class}}" scope="{{col.header}}">
                          {{col.header}}
                        </th>
                      </tr>
                      <tr>
                        <th *ngFor="let col of columns" [ngSwitch]="col.field" scope="{{col.field}}">

                          <input *ngSwitchCase="'pag_empleado_nombre'" style="width: 100%" placeholder="Buscar"
                            pInputText type="text"
                            (input)="dt.filter($event.target.value, col.field, col.filterMatchMode)"
                            [(ngModel)]="filterEmpleado"
                            (keyup)="filterEmpleado = funcionesGenerales.mayuscula(filterEmpleado)">

                          <input *ngSwitchCase="'pag_valor_pago'" style="width: 100%" placeholder="Buscar" pInputText
                            type="text"
                            (input)="dt.filter(this.funcionesGenerales.formatoMonedaText2($event.target.value), col.field, col.filterMatchMode)"
                            [(ngModel)]="filterValor"
                            (keyup)="filterValor = this.funcionesGenerales.formatoMonedaText2(filterValor)">

                          <input *ngSwitchCase="'pag_cantidad_tiquetes'" style="width: 100%" placeholder="Buscar"
                            pInputText type="number"
                            (input)="dt.filter($event.target.value, col.field, col.filterMatchMode)"
                            [(ngModel)]="filterCantidad">


                          <p-multiSelect *ngSwitchCase="'pag_area'" [options]="areas" [style]="{'width':'100%'}"
                            defaultLabel="Areas" (onChange)="dt.filter($event.value, col.field, 'in')"
                            selectedItemsLabel="{0} Areas seleccionadas" [(ngModel)]="filterArea">
                          </p-multiSelect>

                          <p-calendar class="calendarModal" showButtonBar="true" *ngSwitchCase="'pag_fecha'"
                            [style]="{'width':'100%'}" [locale]="funcionesGenerales.es" dateFormat="yy-mm-dd"
                            [readonlyInput]="true" [touchUI]="true" placeholder="F. creación" [(ngModel)]="filterFecha"
                            (onSelect)="dt.filter(funcionesGenerales.formatearFechaCorta($event), col.field, col.filterMatchMode);"
                            (onClearClick)="dt.filter('', col.field, col.filterMatchMode);">
                          </p-calendar>

                        </th>
                      </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-columns="columns">
                      <tr [pSelectableRow]="rowData">
                        <td *ngFor="let col of columns" [ngSwitch]="col.field">

                          <p *ngSwitchCase="'pag_cantidad_tiquetes'" style="text-align: right; color: black;">
                            {{rowData[col.field]}}</p>

                          <p *ngSwitchDefault style="color: black;">{{rowData[col.field]}}
                          </p>

                          <div *ngSwitchCase="'visualizar'" class="centrarFlex">
                            <button type="button" pButton (click)="verPago(rowData)" icon="pi pi-eye"></button>
                          </div>

                        </td>
                      </tr>
                    </ng-template>
                  </p-table>

                </div>
              </perfect-scrollbar>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>



<p-dialog class="modal-content max" [(visible)]="display" [modal]="true" [style]="{'width':'auto'}" [blockScroll]="true"
  [closable]="false" [responsive]="true">
  <p-header>
    <h1>{{ title }} PAGO</h1>
  </p-header>
  <div class="layout-content">
    <div class="card">
      <div class="card-content ui-fluid">
        <div class="card card-w-title">

          <div class="p-grid">
            <div class="p-col-12">
              <div class="p-grid">

                <div class="p-lg-3" style="margin-top: 2%;">
                  <span class="ui-float-label">
                    <input id="float-input" type="text" pInputText
                      [(ngModel)]="Pago.pag_empleado.nombre" [(disabled)]="viwer">
                    <label for="float-input">Empleado</label>
                  </span>
                </div>

                <div class="p-lg-3" style="margin-top: 2%;">
                  <span class="ui-float-label">
                    <input id="float-input" type="text" pInputText [(ngModel)]="Pago.pag_area"
                      [(disabled)]="viwer">
                    <label for="float-input">Area</label>
                  </span>
                </div>

                <div class="p-lg-3" style="margin-top: 2%;">
                  <span class="ui-float-label">
                    <input id="float-input" type="text" pInputText
                      [(ngModel)]="Pago.pag_valor_pago" [(disabled)]="viwer">
                    <label for="float-input">Valor pagado</label>
                  </span>
                </div>

                <div class="p-lg-3" style="margin-top: 2%;">
                  <span class="ui-float-label">
                    <input id="float-input" type="text" pInputText [(ngModel)]="Pago.pag_fecha"
                      [(disabled)]="viwer">
                    <label for="float-input">Fecha del pago</label>
                  </span>
                </div>

              </div>
            </div>

            <div class="p-col-12">
              <p>Tickets pagados: {{Pago.pag_cantidad_tiquetes}}</p>
              <div class="p-lg-12">
                <p-dataTable [value]="tickets" expandableRows="true"
                  emptyMessage="lista vacía" selectionMode="single" class="tableMin">
                  <p-header>
                  </p-header>
                  <p-column field="tiq_codigo" header="Codigo"></p-column>
                  <p-column field="tiq_color" header="Referencia"></p-column>
                  <p-column field="tiq_planta" header="Planta"></p-column>
                  <p-column field="tiq_pares" header="Cantidad pares"></p-column>
                  <p-column field="tiq_precio_par" header="Precio par"></p-column>
                </p-dataTable>
              </div>
            </div>

          </div>


        </div>
      </div>
      <div class="card-action">
        <div class="center-flex input-field col 12" *ngIf="!viwer">
          <button class="btn-polaris" type="button" pButton label="Registrar" (click)="registrarEmpleado()"
            icon="icommon pi pi-save"></button>
        </div>
        <div class="center-flex input-field col 12" *ngIf="!viwer">
          <button class="btn-polaris" type="button" pButton label="Actualizar" (click)="actualizarEmpleado()"
            icon="icommon pi pi-pencil"></button>
        </div>
        <!-- aca en disable va la validacion del formulario -->
      </div>
    </div>
  </div>
  <p-footer>
    <button type="button" pButton icon="icommon pi pi-arrow-left" (click)="display=false" (click)="limpiarFormulario()"
      label="Volver"></button>
  </p-footer>
</p-dialog>



<p-confirmDialog class="confirmDialogModal" header="Confirmar" icon="fa fa-question-circle" #cd>
  <p-footer>
    <button class="btn-polaris" type="button" pButton icon="icon-checked" style="text-align: center" label="Sí"
      (click)="cd.accept()"></button>
    <button class="btn-polaris" type="button" pButton icon="icon-cancel" style="text-align: center" label="No"
      (click)="cd.reject()"></button>
  </p-footer>
</p-confirmDialog>
<p-toast key="tst" [style]="{marginTop: '70px'}"></p-toast>
<app-footer></app-footer>
<div class="layout-mask"></div>